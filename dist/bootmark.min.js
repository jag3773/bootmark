/**!
* @file bootmark: markdown + bootstrap as a jQuery plugin
* @author [obedm503](https://github.com/obedm503/)
* @git [git repo](https://github.com/obedm503/bootmark.git)
* @examples [examples/starters/templates](https://obedm503.github.io/bootmark/docs/examples.html)
* @version 0.7.1
* @license MIT
*/
!function(window,document){"use scrict";function defineBootmark(){var defaults={markdown:!1,fetch:!1,join:"----",css:"https://obedm503.github.io/bootmark/dist/bootmark.min.css",promise:!1,template:{text:!1,fetch:!1,id:"bootmark-template"},html:{favicon:"https://obedm503.github.io/bootmark/bootmark-favicon.png",indent:!1,toc:!0,tocTitle:window.$(document).attr("title"),tocId:"nav",theme:"readable",prettifyTheme:"atelier-forest-light",prettify:!0,credit:!0},showdown:{parseImgDimensions:!0,simplifiedAutoLink:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,tasklists:!0,extensions:[]}};window.$.fn.bootmark=function(t){var e=this;e.hide(),t=_private.parseObject(t,["fetch","html","showdown","template"]);var o=window.$.extend(!0,{},defaults,window.$.fn.bootmark.options||{},t);o.html.prettify&&o.showdown.extensions.indexOf("prettify")<0&&"undefined"!=typeof window.prettyPrint&&o.showdown.extensions.push("prettify"),_private.insertMeta("viewport","width=device-width, initial-scale=1"),_private.insertLink("https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/"+o.html.theme.toLowerCase().trim()+"/bootstrap.min.css"),o.html.favicon&&_private.insertLink(o.html.favicon,"image/x-icon","shortcut icon"),_private.insertLink(o.css),o.showdown.extensions.indexOf("prettify")>=0&&_private.insertLink("https://jmblog.github.io/color-themes-for-google-code-prettify/themes/"+o.html.prettifyTheme.toLowerCase().trim().replace(/ /g,"-")+".min.css");var n=[_private.getTemplate(o),_private.getMarkdown(e,o)],i=window.Promise.all(n).then(function(t){var n=new window.showdown.Converter(o.showdown).makeHtml(t[1]);return e.html(_private.replaceHtml(t[0],n)),_private.doDom(e,o),n}).catch(console.error);return o.promise?i.then(function(t){return e.show(),t}):(i.then(function(){e.show()}),e)};var _private={insertLink:function(t,e,o){if(!window.$('link[href="'+t+'"], link[type="'+e+'"], link[rel="'+o+'"]').length){var n=window.$("<link />");n.attr({href:t,type:e||"text/css",rel:o||"stylesheet"}),window.$("head").append(n)}},insertMeta:function(t,e){if(!window.$('meta[content="'+e+'"]').length){var o=window.$("<meta />");o.attr({name:t,content:e}),window.$("head").append(o)}},parseObject:function(obj,props){for(var i in obj)i&&"string"==typeof obj[i]&&obj.hasOwnProperty(i)&&props.indexOf(i)>=0&&("fetch"===i?"["===obj[i].trim()[0]&&(obj[i]=eval("("+obj[i]+")")):obj[i]=eval("("+obj[i]+")"));return obj},replaceHtml:function(t,e){return t.replace(/\$\{bootmark\}/gi,e)},getMarkdown:function(t,e){return new Promise(function(o,n){if(e.markdown)o(e.markdown);else if(e.fetch)if("string"==typeof e.fetch)window.fetch(e.fetch).then(function(t){return t.text()}).then(o).catch(n);else{var i=e.fetch.map(function(t){return window.fetch(t).then(function(t){return t.text()})});window.Promise.all(i).then(function(t){return t.join("\n\n"+e.join+"\n\n\n")}).then(o).catch(n)}else o(t.text())})},getTemplate:function(t){return new Promise(function(e,o){if(t.template.text)e(t.template.text);else if(t.template.fetch)window.fetch(t.template.fetch).then(function(t){return t.text()}).then(function(t){var e=window.$("<div></div>").html(t);return window.$("template",e).html()}).then(e).catch(o);else if(window.$("#"+t.template.id).length)e(window.$("#"+t.template.id).html());else if(t.html.toc){var n=t.html.tocTitle.replace(/ /gi,"-");e('<div class="container-fluid" id="'+n+'"><div class="row"><div class="col-sm-3 col-md-3 col-lg-2"><nav class="navbar navbar-default navbar-fixed-side"><div class="container-fluid"><div class="navbar-header"><button class="navbar-toggle" data-target="#'+t.html.tocId+'" data-toggle="collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand active page-scroll" href="#'+n+'">'+t.html.tocTitle+'</a></div><div class="collapse navbar-collapse" id="'+t.html.tocId+'"><ul class="bootmark-toc nav navbar-nav"></ul></div></div></nav></div><div class="bootmark-main has-toc col-sm-9 col-md-9 col-lg-10">${bootmark}</div></div></div>')}else e('<div class="container"><div class="row"><div class="bootmark-main">${bootmark}</div></div></div>')})},doDom:function(t,e){if(window.$('a[href^="#"]',t).length){var o=window.$('a[href^="#"]',t);o.each(function(){window.$(this).addClass("page-scroll")})}if(window.$("#"+e.html.tocId,t).length){var n=window.$("#"+e.html.tocId,t);n.on("click","a",function(){n.collapse("hide")})}if(e.html.toc){var i=window.$("ul.bootmark-toc",t),a=window.$("h1, h2, h3, h4, h5, h6",t);a.each(function(t,e){var o=window.$("<li></li>").addClass("bootmark-"+e.localName).html(' <a class="page-scroll" href="#'+e.id+'">'+e.innerText+"</a>");i.append(o)})}if(window.$("table",t).length&&window.$("table",t).addClass(" table table-striped table-bordered ").wrap(' <div class="table-responsive"></div> '),e.html.indent&&window.$("p",t).length&&window.$("p",t).addClass("bootmark-indent"),e.html.credit&&!window.$("#bootmark-footer").length){var r='<div class="container-fluid bg-primary"><p class="text-center"><a style="color: inherit" href="https://obedm503.github.io/bootmark">This project uses bootmark. Bootmark allows developers to focus on their projects and not how they are presented.</a><p></div>',d=window.$('<footer id="bootmark-footer"></footer>').html(r);window.$("body").append(d)}e.showdown.extensions.indexOf("prettify")>=0&&window.prettyPrint()}};window.$(function(){window.$(document).on("click","a.page-scroll",function(t){t.preventDefault();var e,o=$(this),n=o.attr("href").substring(1);window.$("#"+n).length?e=window.$("#"+n)[0]:window.$('a[name="'+n+'"]').length&&(e=window.$('a[name="'+n+'"]')[0]),e&&window.$("html, body").animate({scrollTop:e.offsetTop},900)}),window.$("bootmark").length&&window.$("bootmark").each(function(){var t=window.$(this);t.bootmark({fetch:t.attr("fetch"),join:t.attr("join"),template:t.attr("template"),html:t.attr("html"),css:t.attr("css"),showdown:t.attr("showdown"),promise:t.attr("promise")})}),window.$(".bootmark").length&&window.$(".bootmark").each(function(){var t=window.$(this);t.bootmark({fetch:t.attr("data-fetch"),join:t.attr("data-join"),template:t.attr("data-template"),html:t.attr("data-html"),css:t.attr("data-css"),showdown:t.attr("data-showdown"),promise:t.attr("data-promise")})})})}if("undefined"==typeof window.$)throw new Error("JQuery is not defined");if("undefined"==typeof window.showdown)throw new Error("Showdown is not defined");if("undefined"==typeof window.$.fn.modal)throw new Error("Bootstrap is not defined");if("undefined"==typeof window.Promise)throw new Error("Promise API is not defined");"undefined"==typeof window.fetch&&console.warn("fetch API is not defined"),"undefined"==typeof window.prettyPrint&&console.warn("Code Prettify is not defined"),"undefined"==typeof window.$.fn.bootmark&&defineBootmark()}(window,document);